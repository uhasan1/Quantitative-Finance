## https://www.c-sharpcorner.com/blogs/read-csv-file-into-data-table1
## Datatable and Dataset

using System;
using System.Collections;
using System.Collections.Generic;
using System.Globalization;
using System.IO;
using System.Linq;
using System.Linq.Expressions;
using System.Text;
using System.Data;
using System.Data.OleDb;

namespace CSVFileParser
{
    public class HanoiFX
    {
        public int UploadFlag { get; set; }
        public string Code { get; set; }
        public int SourceData { get; set; }
        public string DealerID { get; set; }
        public string Bank1DealingCode { get; set; }
        public string BrokerDealingCode { get; set; }
        public int DealType { get; set; }
        public string Currency1 { get; set; }
        public double DealVolumeCurrency1 { get; set; }
        public DateTime ValueDatePeriod1Currency1 { get; set; }
        public string LocalTCID { get; set; }
        public string TradingArea { get; set; }
        public string UserDefinedData1 { get; set; }
        public string UserDefinedData5 { get; set; }
        public string Currency2 { get; set; }
        public double ExchangeratePeriod1 { get; set; }
        public int RateDirection { get; set; }

        static void Main(string[] args)
        {
            try
            {
                string data = File.ReadAllText("C:\\Users\\CY2241\\Swap_rates.xlsx");
                Console.WriteLine(data);
            }
            
            catch (Exception e)
            {
                Console.WriteLine("The file could not be read!");
                Console.WriteLine(e.Message);
            }
            
            Console.ReadLine();
        }
    }
}

namespace MrrsExtensions.Pocos
{
    /// <summary>
    /// Poco for VaR Tab in the Market Risk Report. About 500 rows (trading and banking 250 each)
    /// </summary>
    public class ValueAtRisk
    {
        public string MONITORING_SET_NAME { get; set; }
        public string PORTFOLIO { get; set; }
        public DateTime VALUATION_DATE { get; set; }
        public string CURRENCY { get; set; }
        public double VAR { get; set; }//amount of VaR
        public double ADJUSTMENT_FACTOR { get; set; }
        public double? NO_ACTION_PL { get; set; }// this is from back test
        public bool? IsExcess { get; set; }

        public static string GetImportCommand()
        {
            return System.IO.File.ReadAllText(AppDomain.CurrentDomain.BaseDirectory + @"\bin\Queries\Import\Import_TBL_Var.sql");
        }

    }
}

try
            {
                // Read the file using a StreamReader and display the contents
                using (StreamReader sr = new StreamReader(@"C:\Users\r15\Downloads\Hanoi_FX.csv"))
                {
                    string data;
                    do
                    {
                        data = sr.ReadLine();
                        Console.WriteLine(data);
                    } while (data != null);
                }
            }

            catch (Exception e)
            {
                Console.WriteLine("The file could not be read!");
                Console.WriteLine(e.Message);
            }
            Console.ReadLine();
