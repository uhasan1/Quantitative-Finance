Private Declare Sub mouse_event Lib "user32" (ByVal dwFlags As Long, ByVal dx As Long, ByVal dy As Long, ByVal cbuttons As Long, ByVal dwExtraInfo As Long)

Const MOUSEEVENTF_LEFTDOWN As Integer = 2
Const MOUSEEVENTF_LEFTUP As Integer = 4

Dim i As Integer, j As Integer, LastRow_Repo As Integer, LastRow_Extract As Integer

Declare Function apiShowWindow Lib "user32" Alias "ShowWindow" _
            (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long

Global Const SW_MAXIMIZE = 3
Global Const SW_SHOWNORMAL = 1
Global Const SW_SHOWMINIMIZED = 2

Sub AccessWeb()

''DECLARE VARIABLES
Dim IE As Object 'Special object variable representing the IE browser

''CLEAR REPO RATES FOR PREVIOUS DAY
Range("E1:E" & Rows.Count).ClearContents

''INSTANTIATE A NEW INSTANCE OF IE BROWSER
Set IE = CreateObject("InternetExplorer.application")

''MAKE IE BROWSER VISIBLE
IE.Visible = True
apiShowWindow IE.hwnd, SW_MAXIMIZE

''NAVIGATE IE TO HANOI STOCK EXCHANGE
IE.navigate "https://owa.hnx.vn/ftp///THONGKEGIAODICH//" + Trim(Str(ThisWorkbook.Worksheets("Extract").Cells(1, 2).Value)) + _
"/TP/" + Trim(Str(ThisWorkbook.Worksheets("Extract").Cells(1, 2).Value)) + "_TP_Repos_statistics_by_repos_term.pdf"

''CATER 5 SECONDS WAITING TIME TO LOAD IE BROWSER
Application.Wait TimeSerial(Hour(Now()), Minute(Now()), Second(Now()) + 15)

''TRIGGER MOUSE CLICKS AND KEY STROKES TO COPY THE DATA TO EXCEL
Call mouse_event(MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0) 'Click left mouse
Call mouse_event(MOUSEEVENTF_LEFTUP, 0, 0, 0, 0) 'Release left mouse
Application.Wait TimeSerial(Hour(Now()), Minute(Now()), Second(Now()) + 1)
SendKeys ("^a")
Application.Wait TimeSerial(Hour(Now()), Minute(Now()), Second(Now()) + 1)
SendKeys ("^c")
Application.Wait TimeSerial(Hour(Now()), Minute(Now()), Second(Now()) + 1)
AppActivate "Microsoft Excel"
ThisWorkbook.Activate
Worksheets("Extract").Activate
Range("E1").Activate
Application.Wait TimeSerial(Hour(Now()), Minute(Now()), Second(Now()) + 1)
SendKeys ("^v")

End Sub

Sub Extract()

''EXTRACT IMPORTANT FIELDS
LastRow_Extract = ThisWorkbook.Worksheets("Extract").Cells(Rows.Count, 5).End(xlUp).Row
LastRow_Repo = ThisWorkbook.Worksheets("REPO_OMO").Cells(Rows.Count, 1).End(xlUp).Row

For i = 3 To LastRow_Extract
    If IsNumeric(Split(ThisWorkbook.Worksheets("Extract").Cells(i, 5), " ")(0)) And _
    Split(ThisWorkbook.Worksheets("Extract").Cells(i, 5), " ")(1) <= 31 And _
    Split(ThisWorkbook.Worksheets("Extract").Cells(i, 5), " ")(2) <> "Guaranteed" Then
        ThisWorkbook.Worksheets("REPO_OMO").Cells(LastRow_Repo + 1, 1) = Mid(Trim(Str(ThisWorkbook.Worksheets("Extract").Cells(1, 2).Value)), 5, 2) + "/" + _
                                                      Right(Trim(Str(ThisWorkbook.Worksheets("Extract").Cells(1, 2).Value)), 2) + "/" + _
                                                      Left(Trim(Str(ThisWorkbook.Worksheets("Extract").Cells(1, 2).Value)), 4)
        ThisWorkbook.Worksheets("REPO_OMO").Cells(LastRow_Repo + 1, 2) = Split(ThisWorkbook.Worksheets("Extract").Cells(i, 5), " ")(1)
        ThisWorkbook.Worksheets("REPO_OMO").Cells(LastRow_Repo + 1, 3) = Split(ThisWorkbook.Worksheets("Extract").Cells(i, 5), " ")(8)
        ThisWorkbook.Worksheets("REPO_OMO").Cells(LastRow_Repo + 1, 4) = Split(ThisWorkbook.Worksheets("Extract").Cells(i, 5), " ")(6)
        ThisWorkbook.Worksheets("REPO_OMO").Cells(LastRow_Repo + 1, 5) = Split(ThisWorkbook.Worksheets("Extract").Cells(i, 5), " ")(5)
        LastRow_Repo = LastRow_Repo + 1
    End If
Next i

End Sub


driver = webdriver.PhantomJS(executable_path=r'C:\Users\r15\phantomjs-2.1.1-windows\bin\phantomjs.exe')
driver.get('https://duckduckgo.com')
driver.find_element_by_id('search_form_input_homepage')
driver.sendKeys('python')
driver.save_screenshot('1.png')
#elem.send_keys(Keys.RETURN)
#driver.find_element_by_id('search_button_homepage').click()

driver.close()
